<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.shop.mapper.OrderDetailMapper">
	<!-- cart의 내용을 주문상세에 입력 -->
	<insert id="cart_to_detail">
		INSERT INTO order_detail(order_key, item_key, price, cnt) 
		VALUES(
		(SELECT order_key FROM total_order WHERE cust_key=${cust_key} ORDER BY order_key DESC LIMIT 1),
		${o.item_key}, ${o.item_sale},${o.item_cnt})
	</insert>
	<!-- order_key 이용해서 주문상세 갖고오기 -->
	<select id="get_orderdetail_by_orderkey" parameterType="Integer" resultType="OrderDetailDTO">
		SELECT od.price, i.name AS item_name, od.cnt, i.img1 AS item_img FROM item i
		INNER JOIN order_detail od on i.item_key=od.item_key
		WHERE order_key=${order_key};
	</select>
</mapper>